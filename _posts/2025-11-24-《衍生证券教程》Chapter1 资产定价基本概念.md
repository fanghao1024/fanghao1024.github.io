---

layout: post
title: "《衍生证券教程》第一章 资产定价基本概念 笔记"
description: ""
author:     "Hao"
category: true
tagline: "衍生品"
tags: [finance math , derivative pricing]

---
格式更好的[html版本](https://www.fanghao.work/2025/11/19/%E8%A1%8D%E7%94%9F%E8%AF%81%E5%88%B8%E6%95%99%E7%A8%8B-Chapter1-%E8%B5%84%E4%BA%A7%E5%AE%9A%E4%BB%B7%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/)
## 单期二叉树模型中的状态价格

假定

$$
\frac{S_u}{S}>e^{rT}>\frac{S_d}{S} \tag{1.1}
$$

以上为无套利条件。

看涨期权的$\Delta$定义为：$\delta=(C_u-C_d)/(S_u-S_d)$

$$
\begin{align*}
\delta&=(C_u-C_d)/(S_u-S_d)\\
&\Rightarrow \delta S_u-C_u=\delta S_d -C_d\\
&\text{ 考虑一个在时间0买入}\delta\text{份股票的投资组合，借入美元现金为：}\\
&\Rightarrow e^{-rT}(\delta S_u-C_u)=e^{-rT}(\delta S_d -C_d) \\
&\text{投资者在时间T欠的美元现金为}\\
&\Rightarrow \delta S_u-C_u=\delta S_d -C_d\\
\end{align*}
$$

时间T，上升状态下投资组合的价值为：

$$
\delta\text{份股票的价值-所欠美金}=\delta S_u-(\delta S_u-C_u)=C_u
$$

下降状态下，投资组合的价值为：

$$
\delta\text{份股票的价值-所欠美金}=\delta S_d-(\delta S_d-C_d)=C_d
$$

由此看出，购买$\delta$份股票和借入现金（即采用保证金购买方式购买股票）形成的投资组合**复制**了看涨期权，因此时间0时的期权价值C必定与时间0时的投资组合成本相等，即

$$
C=\delta\text{份股票的成本-所借美金}=\delta S - e^{-rT}(\delta S_u -C_u) \tag{1.2}
$$

由于看涨期权与以保证金购买方式买入股票等价，因此可以看作在股票上的**杠杆投资**

将期权定价公式（1.2）用\*\*”状态价格“\*\*表示。将（1.2）中的$\delta$进行替换并整理，可以得出：

$$
C=\frac{S-e^{-rT}S_d}{S_u-S_d}\times C_u + \frac{e^{-rT}S_u-S}{S_u-S_d} \times C_d \tag{1.3a}
$$

同样简单代数运算得出：

$$
S=\frac{S-e^{-rT}S_d}{S_u-S_d}\times S_u + \frac{e^{-rT}S_u-S}{S_u-S_d} \times S_d \tag{1.3b}
$$

和

$$
1=\frac{S-e^{-rT}S_d}{S_u-S_d}\times e^{rT} + \frac{e^{-rT}S_u-S}{S_u-S_d} \times e^{rT} \tag{1.3c}
$$

用另一种符号表示上式中的两个因子：

$$
\pi_u=\frac{S-e^{-rT}S_d}{S_u-S_d},\pi_d=\frac{e^{-rT}S_u-S}{S_u-S_d} \tag{1.4}
$$

$\pi_u$和$\pi_d$称为==”状态价格“==，反映了市场在初始时刻对”上涨状态或下跌状态发生时获得1单位支付“的定价。

用（1.4）定义的符号改写（1.3a）—（1.3c）：

$$
C=\pi_u C_u + \pi_d C_d \tag{1.5a}
$$

$$
S=\pi_u S_u + \pi_d S_d \tag{1.5b}
$$

$$
1=\pi_u e^{rT}+\pi_d e^{rT} \tag{1.5c}
$$

上面三式可以解释为：今日的证券价格等于上升状态的价值乘以$\pi_u$加上下降状态的价值乘以$\pi_d$

(1.5b)可以理解为：股票等价于由$S_u$份第一类阿罗证券和$S_d$份第二类阿罗证券构成的投资组合。

==状态价格$\pi(\omega)$指：为了在状态$\omega$发生时获得\$1的收益，现在需要支付的价格。它已经包含了概率和风险偏好的综合权重，是一个经风险调整过的概率权重。其将”这件事发生的可能性“和”这件事发生的好坏“两个因素打包成了一个单一权重。==

这个价格 $\pi(\omega)$ 并不是凭空产生的，它是市场根据以下两个核心因素决定的：

1.  状态$\omega$发生的可能性（概率\$ P(\\omega)\$）：一个几乎不可能发生的状态，它的状态价格自然会非常低。
2.  市场对状态 $\omega$ 所承载风险的态度（风险厌恶 / 偏好）：如果状态 $\omega$ 是一个大家都讨厌的 “坏状态”（比如经济危机），那么为了在这种情况下能拿到 1 元钱，人们可能愿意支付更高的价格（就像购买保险一样）。

> 一个通俗的例子：  
> 火灾保险假设你的房子价值 100 万元。有两种可能的未来状态：
> 
> $\omega$：房子失火，价值变为 0。
> 
> $\omega_2$：房子安全，价值仍为 100 万。
> 
> 真实概率：假设失火的概率 \$P(\\omega_1) = 0.01 \$(1%)，安全的概率 \$P(\\omega_2) = 0.99 (99%)。现在，你想为房子买一份保险，保障在失火时能获得 100 万元的赔偿。保险公司会怎么定价这份保险？如果只看概率：保险公司预期的赔付金额是 \$0.01 $\times$ 100万 + 0.99 $\times 0 = 1万$ 元。但实际保费会更高：因为保险公司需要盈利，并且要覆盖运营成本和承担风险。
> 
> 假设保险公司向你收取 1.2 万元 的保费。这里的 1.2 万元保费，就可以看作是状态 $\omega$（失火）发生时，获得 100 万元收益的状态价格。我们可以把它归一化到获得 1 元收益的情况：$\pi(\omega_1) = \frac{1.2万}{100万} = 0.012$这个 $\pi(\omega_1) = 0.012$ 就是 “失火” 这个状态的状态价格。它不等于真实概率 $P(\omega_1) = 0.01$，而是比它高，这高出的部分就体现了风险溢价。对于 “安全” 这个状态 $\omega_2$，因为它不会给你带来额外的收益（你的房子本来就安全），所以它的状态价格 $\pi(\omega_2) = 0$。
> 
> ​ 现在，我们用状态价格公式来计算你为了获得 “房子失火时得到 100 万” 这个权益，需要支付的总价格（也就是保费）：$\text{保费} = \pi(\omega_1) \times 100万 + \pi(\omega_2) \times 0 = 0.012 \times 100万 = 1.2万 \text{元}$这个结果与我们的直觉完全相符！公式完美地工作了，而且它没有，也不需要再乘以一个概率 $P(\omega)$，因为 $\pi(\omega)$ 已经包含了概率的信息，并且做了风险调整。

条件$\pi_u>0$和$\pi_d>0$完全等价于”无套利“假设（1.1），因此得出结论：

> 当不存在套利机会时，存在正的价格状态，使得任何证券的价格都可以表示为各种状态下的回报乘以状态价格然后求和。

## 概率与计价物

将上升状态和下降状态的风险中性概率分别定义为$\pi_u e^{rT}$和$\pi_d e^{rT}$，并分别用$p_u$和$p_d$表示。采用这些符号重写（1.5a）—（1.5c）：

$$
C=e^{-rT}[p_uC_u+p_dC_d] \tag{1.6a}
$$

$$
S=e^{-rT}[p_uS_u+p_dS_d] \tag{1.6b}
$$

$$
1=p_u+p_d \tag{1.6c}
$$

(1.6a)和(1.6b)表明，今日的证券价格等于T时股票价格（关于风险中性概率的）的数学期望以无风险利率贴现的现值。这些公式都是”现值”公式，但与资本资产定价模型不同，贴现率中不包含风险溢价。即在对资产进行定价时，可以对概率进行调整，使投资者像是风险中性一样。当然，这里并没有真正将投资者假定为风险中性，而是将风险溢价体现在概率的调整上。

相关术语：

- 概率测度：时间的概率，简称测度。
- 计价物：一种资产的价格与另一种资产的价格之比，是以第二种（分母）资产为计价物的第一种（分子）资产的价值。
- 鞅：随时间变化的随机变量，如果其未来的期望值总等于当前值。

==**如果不存在套利机会，对应每一项（不支付红利的）资产，都存在一个概率测度，使得任何其他（不支付红利的）资产的价格与该资产（计价物）的价格之比是一个鞅**。==

以上结论提供了计算衍生证券价值足够的概率信息，不需要计算具体的概率值。

### 连续状态的资产定价

本节定义不同计价物下状态价格和概率的概念，展示的是金融衍生品定价理论中的一个核心内容——“基本定价方程”的数学构建过程。它用严谨的数学语言将直观的“状态价格”概念一般化，是理解现代金融定价理论的基石。

本小节的梳理逻辑：

目标：给一个不确定的未来收益（如期权）定价。

原理：无套利原则要求必须存在一套“公平”的定价体系。

初始工具：我们找到了“状态价格密度” φ(T)这把万能尺子，可以直接度量未来价值在今天的价格（公式1.10）。

巧妙简化：我们发现，与其费力地直接使用这把尺子，不如换一个“宇宙”（即概率测度）来生活。在这个新宇宙里，所有人的风险偏好都是中性的，都只要求无风险收益。原来那把复杂的尺子 φ(T)在新宇宙的规则下消失了。

最终方程：在新宇宙里，定价变得极其简单：任何资产的今天价格，就等于其未来价格在新概率下的期望值，再用无风险利率折现回来。这就是衍生品定价的终极形式——“基本定价方程”的精髓。

本小节正是从原始的、直接的状态价格概念（公式1.10）出发，通过引入计价物和概率测度变换（公式1.11, 1.12），为得出最终简洁实用的定价公式铺平了道路。这是连续时间金融理论中连接直觉与数学的关键桥梁。

考虑无红利支付证券，T时的证券价格为随机变量$S(T)$。各种可能出现的、影响价格S(T)的状况称为==“状态”==。上一节的状态价格原理可以表述为更一般的形式：

> 如果不存在套利机会，则对每个时间T，都存在正的随机变量$\phi(T)$，使得无红利支付证券在时间0的价值为
> 
> $$
> S(0)=\mathbb{E}[\phi(T)S(T)] \tag{1.10}
> $$

其中随机变量$\phi(T)$称为==“状态价格密度”==。可以把 φ(T)理解为一个“价值折算因子”，但它不是固定的，而是依赖于未来不同的“状态”（比如经济繁荣、衰退等）。（1.10）这个公式的意思是：今天的公平价格，等于未来各种可能价格经过“状态价值”调整后的平均期望值。φ(T)负责将未来不同状态下的钱，折算成今天同等价值。

在一个离散的世界里，资产的当前价格就是未来所有可能状态下的收益乘以对应状态的状态价格，然后求和，即$S(0)=\sum_\omega \pi(\omega)\cdot S(\omega)$，即把各种情况下的收益都换算成今天的钱，然后加起来。

在现实世界中我们更习惯使用概率来思考问题：$S(0)=\sum_\omega(\frac{\pi(\omega)}{p(\omega)})\cdot S(\omega)\cdot p(t)=\mathbb{E}[\phi(T)S(T)]$

但是，直接使用$\phi(T)计算有时很麻烦，所以通过巧妙地调整概率的权重，将$$\phi(T)$吸收到新的概率定义中，从而简化计算。

以S为计价物时事件A的概率定义为：

$$
\text{prob}^S(A)=\mathbb{E}[1_A \phi(T)\frac{S(T)}{S(0)}] \tag{1.11}
$$

以S为计价物时随机变量X的数学期望是

$$
\mathbb{E}^{Q_S}[X]=\mathbb{E}[X \phi(T)\frac{S(T)}{S(0)}] \tag{1.12}
$$

公式（1.12）的核心目的是定义一个全新的数学期望\$ E^{Q_S}\[\\cdot\]\$$。$E\[\\cdot\]$是在我们熟悉的、基于历史数据和真实风险偏好的现实世界概率测度下的期望。$E^{Q_S}\[ \\cdot \]\$是在一个人造的、以资产S为计价物的概率测度 $Q_S$下的期望。这个新测度是为了定价方便而构造的。

公式（1.12）就是连接这两个世界的桥梁。它明确规定：“在你这个以S为计价物的新世界\$ Q_S\$里，计算一个变量X的期望值，等价于在我们原来的真实世界里计算 φ(T) \* \[S(T)/S(0)\] \* X的期望值。”

> 转换前：资产价格 = 在“真实世界”的概率下，计算【未来价格 × 状态价格】的平均值。
> 
> $\longrightarrow$公式复杂，因为包含了难以捉摸的 φ(T)。
> 
> 转换后：资产价格 = 在“以S为计价物的世界”的概率下，计算【资产与计价物的相对价格 (V/S)】的平均值，然后再用计价物的当前价格 (S(0)) 放大回来。
> 
> $\longrightarrow$公式简洁，φ(T)神奇地消失了，被吸收到了新概率 Q_S的定义中。
> 
> 一个简单的比喻：
> 
> 想象用一把刻度不均匀的“状态价格尺”φ(T)去测量物品V的价值，很麻烦。
> 
> “概率转换”相当于我们换了一把刻度均匀的新尺子（新概率测度 Q_S），这把新尺子是以一个参照物 S为标准刻度的。
> 
> 在新尺子下，我们只需要测量物品V相对于参照物S的价值（即 V/S），然后用参照物本身的价格 S(0)一乘，就得到了物品 V的绝对价格。
> 
> 最重要的特例：风险中性测度
> 
> 当选择的计价物 S是无风险资产（比如银行存款）时，即 S(t) = e^{rt}，这个新概率测度就称为风险中性测度。在这个测度下，所有资产的预期收益率都等于无风险利率 r，这使得衍生品定价变得非常方便。你所熟知的布莱克-斯科尔斯期权定价公式，就是在这个框架下推导出来的。

### 基本定价公式

$$
Y(t)=S(t)\mathbb{E}^S_t[\frac{Y(T)}{S(T)}] \tag{1.17}
$$

此公式为==基本定价公式==，是现代衍生证券定价的核心。

它是一个现值关系：资产在时间t的价值是其在T时的价值以$S(t)/S(T)$为折现因子（可以是随机的）折现后的数学期望。

为了表明计价物可以是任何无红利支付的资产（而不是必须为S表示的股票价格），将（1.17）写成另一种等价的形式：

$$
Y(t)=num(t)\mathbb{E}^{\text{num}}_t[\frac{Y(T)}{\text{num(T)}}] \tag{1.17'}
$$

设$R(t)$表示无风险资产价格$e^{rt}$，并以此作为计价物，等式（1.17）为

$$
Y(t)=e^{rt}\mathbb{E}^R_t[\frac{Y(T)}{e^{rT}}]=e^{-r(T-t)}\mathbb{E}^R_t[Y(T)] \tag{1.18}
$$

## 期权定价入门

将复杂的回报分解为简单合约的方法，是对各种衍生品进行分析的关键所在。

### 股份数字合约的定价

$$
Y(T)=\begin{cases}
S(T) \quad \text{if }S(T)>K\\ 0 \quad \text{ else}
\end{cases}
$$

$$
\begin{align*}
\mathbb{E}^{\text{num}}[\frac{Y(T)}{\text{num(T)}}]&=\mathbb{E}^{\text{num}}[\frac{Y(T)}{\text{num(T)}}|S(T) \geq K]\cdot \text{prob}^S(S(T)\geq K)\\
&+\mathbb{E}^{\text{num}}[\frac{Y(T)}{\text{num(T)}}|S(T) < K]\cdot \text{prob}^S(S(T)< K)\\
&=\mathbb{E}^{\text{num}}[1|S(T) \geq K]\cdot \text{prob}^S(S(T)\geq K)\\
&=\text{prob}^S(S(T)\geq K)
\end{align*}
$$

这说明股份数字合约的价值为

$$
S(0)\times\text{prob}^S(S(T)\geq K)
$$

### 数字合约定价

$$
Y(T)=\begin{cases}
1 \quad \text{if }S(T)>K\\ 0 \quad \text{ else}
\end{cases}
$$

需要计算的$Y(0)$为：

$$
Y(0)=num(0)\mathbb{E}^{\text{num}}[\frac{Y(T)}{num(T)}]
$$

选择无风险资产R(t)作为计价单位，则

$$
Y(T)=K \cdot 1_{S_T \geq K}\\
num(t)=R(t)=e^{rt}\\
num(0)=1\\
num(T)=e^{rT}
$$

$$
\begin{align*}
Y(0)&=num(0)\cdot\mathbb{E}^R[\frac{Y(T)}{num(T)}]\\
&=1\cdot \mathbb{E}^R[\frac{K \cdot 1_{S_T \geq K}}{e^{rT}}]\\
&=e^{-rT}\cdot K\cdot \mathbb{E}^R[1_{S_T \geq K}]\\
&=e^{-rT}\cdot K\cdot \text{prob}^R[S(T)\geq K]
\end{align*S}
$$

计价物转换只不过是一种“计算技巧”。从根本上说，这种方法之所以可行是因为定价是线性的。这种线性性表现在，一个现金流的价值等于不同状态下的现金流与状态价格相乘后求和。计价物变换正是采用了线性性来简化有关的定价过程。

### 一个不完全市场的例子

在三叉树模型中，看涨（或看跌）期权具有多个无套利价格，原因在于无法用股票和无风险资产复制看涨期权，或者等价地说，不存在看涨期权的$\Delta$对冲。

当存在与状态有关的未定权益不能通过市场化资产的交易进行复制时，称市场是“不完全”的。

在不完全市场中，要对衍生证券进行定价，必须选择联立方程的某些特定解，并假定市场按照这些解对资产进行定价。这些类型的定价常称为均衡定价，以区别于套利定价，因为对风险中性概率进行选择时，必须给出有关投资者偏好、禀赋和生产能力的假定。（方程数少于未知数个数，故需自行增加约束以求解，相当于添加联立方程）